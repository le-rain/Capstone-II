% Call this function to find peaks for audio files
function [name, peaks, nSamples, x, yAll, Fs, minDist] = findAudioPeaks(audio)

% Values (y) and sample rate (Fs) for file 
[yAll, Fs] = audioread(audio);
[~,name,~] = fileparts(audio);

% Find minimum peak distance with bpm
minDist = (60/300 - 0.05) * Fs;

% Compare first and second channels
y1 = yAll(:,1).^2;
y2 = yAll(:,2).^2;

if mean(y1) > mean(y2)   
    y = y1;
else 
    y = y2;
end    

% Manually choose
% y = yAll(:,1).^2;
y = yAll(:,2).^2;

x = (1:length(y))';

% Find peaks with minimum distance of entered BPM
[peaks, nSamples] = findpeaks(y, 'MinPeakDistance', minDist);

end